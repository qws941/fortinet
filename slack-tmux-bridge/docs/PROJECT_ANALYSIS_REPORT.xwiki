= Slack Tmux Bridge - í”„ë¡œì íŠ¸ ë¶„ì„ ë³´ê³ ì„œ =

{{info}}
**ë¬¸ì„œ ì •ë³´**
* **í”„ë¡œì íŠ¸ëª…**: Slack Tmux Bridge
* **ë²„ì „**: 1.0.0
* **ì‘ì„±ì¼**: 2025-10-01
* **ë¶„ì„ ëŒ€ìƒ**: WebSocket + Slack í†µí•© Tmux ì œì–´ ì‹œìŠ¤í…œ
* **ì´ ì½”ë“œ ë¼ì¸**: 1,252 lines (í…ŒìŠ¤íŠ¸ í¬í•¨)
* **ë¼ì´ì„ ìŠ¤**: MIT
{{/info}}

----

== 1. ê°œìš” (Executive Summary) ==

=== 1.1 í”„ë¡œì íŠ¸ ëª©ì  ===

Slack Tmux BridgeëŠ” **Slack ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì—ì„œ ì›ê²© ì„œë²„ì˜ tmux ì„¸ì…˜ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ì œì–´í•˜ê³  ëª¨ë‹ˆí„°ë§**í•  ìˆ˜ ìˆëŠ” í†µí•© ì†”ë£¨ì…˜ì…ë‹ˆë‹¤. ê°œë°œìì™€ ìš´ì˜íŒ€ì´ ì±„íŒ… ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ í„°ë¯¸ë„ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.

=== 1.2 í•µì‹¬ ê°€ì¹˜ ì œì•ˆ ===

* **ì›ê²© ì‘ì—… íš¨ìœ¨ì„± ì¦ëŒ€**: Slackì—ì„œ ì§ì ‘ í„°ë¯¸ë„ ëª…ë ¹ ì‹¤í–‰
* **ì‹¤ì‹œê°„ í˜‘ì—…**: íŒ€ì›ë“¤ì´ ë™ì¼í•œ í„°ë¯¸ë„ ì¶œë ¥ì„ Slackì—ì„œ ê³µìœ 
* **ì ‘ê·¼ì„± í–¥ìƒ**: ë³„ë„ì˜ SSH í´ë¼ì´ì–¸íŠ¸ ì—†ì´ ì›¹ ë¸Œë¼ìš°ì €ë§Œìœ¼ë¡œ ì‘ì—… ê°€ëŠ¥
* **ê°ì‚¬ ì¶”ì **: ëª¨ë“  ëª…ë ¹ ì‹¤í–‰ì´ Slack ëŒ€í™” ë‚´ì—­ì— ìë™ ê¸°ë¡

=== 1.3 ì£¼ìš” ê¸°ëŠ¥ ìš”ì•½ ===

|= ê¸°ëŠ¥ ë²”ì£¼ |= ì„¸ë¶€ ê¸°ëŠ¥ |= êµ¬í˜„ ìƒíƒœ
| **Slack í†µí•©** | Slash ëª…ë ¹ì–´ ì§€ì› (/tmux) | âœ… ì™„ë£Œ
| **Tmux ì œì–´** | ì„¸ì…˜ ìƒì„±/ì‚­ì œ/ì¡°íšŒ | âœ… ì™„ë£Œ
| **ëª…ë ¹ ì‹¤í–‰** | ì„ì˜ì˜ ëª…ë ¹ì–´ ì‹¤í–‰ ë° ê²°ê³¼ ìˆ˜ì‹  | âœ… ì™„ë£Œ
| **ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë°** | WebSocket ê¸°ë°˜ í„°ë¯¸ë„ ì¶œë ¥ ìŠ¤íŠ¸ë¦¬ë° | âœ… ì™„ë£Œ
| **ì„¸ì…˜ ê´€ë¦¬** | ë‹¤ì¤‘ ì„¸ì…˜ ì§€ì› ë° ìƒíƒœ ëª¨ë‹ˆí„°ë§ | âœ… ì™„ë£Œ

----

== 2. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ë¶„ì„ ==

=== 2.1 ì•„í‚¤í…ì²˜ ê°œìš” ===

{{code language="text"}}
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Slack Workspace                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ì‚¬ìš©ì: /tmux exec ls -la                           â”‚  â”‚
â”‚  â”‚         /tmux list                                    â”‚  â”‚
â”‚  â”‚         /tmux output myproject                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â–¼ (Slash Command Event)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Slack Tmux Bridge Server                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   Slack Bot        â”‚      â”‚   WebSocket Server     â”‚    â”‚
â”‚  â”‚   (Socket Mode)    â”‚      â”‚   (Port 3001)          â”‚    â”‚
â”‚  â”‚  - Command Handler â”‚â—„â”€â”€â”€â”€â–ºâ”‚  - Real-time Stream    â”‚    â”‚
â”‚  â”‚  - Response Format â”‚      â”‚  - Subscription Mgmt   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚             â–¼                            â–¼                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              Tmux Wrapper (API)                      â”‚  â”‚
â”‚  â”‚  - Session Management                                â”‚  â”‚
â”‚  â”‚  - Command Execution                                 â”‚  â”‚
â”‚  â”‚  - Output Capture                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Tmux Sessions                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ session-1  â”‚  â”‚ session-2  â”‚  â”‚ session-n  â”‚           â”‚
â”‚  â”‚ (detached) â”‚  â”‚ (attached) â”‚  â”‚ (detached) â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â–¼
                  ì‹¤ì œ ëª…ë ¹ ì‹¤í–‰ í™˜ê²½
{{/code}}

=== 2.2 í•µì‹¬ ì»´í¬ë„ŒíŠ¸ ìƒì„¸ ë¶„ì„ ===

==== 2.2.1 Slack Bot Handler (slack-bot.js) ====

**ì—­í• **: Slack APIì™€ì˜ í†µì‹  ë° ëª…ë ¹ì–´ ì²˜ë¦¬

**ì£¼ìš” ê¸°ëŠ¥**:
* **Socket Mode í†µí•©**: WebSocket ê¸°ë°˜ ì‹¤ì‹œê°„ ì´ë²¤íŠ¸ ìˆ˜ì‹ 
* **ëª…ë ¹ì–´ ë¼ìš°íŒ…**: 7ê°œì˜ ì„œë¸Œ ëª…ë ¹ì–´ ì²˜ë¦¬
** `list` - ì„¸ì…˜ ëª©ë¡ ì¡°íšŒ
** `create <name>` - ìƒˆ ì„¸ì…˜ ìƒì„±
** `kill <name>` - ì„¸ì…˜ ì¢…ë£Œ
** `exec <name> <cmd>` - ëª…ë ¹ì–´ ì‹¤í–‰
** `output <name>` - ì¶œë ¥ ì¡°íšŒ
** `info <name>` - ì„¸ì…˜ ì •ë³´ ì¡°íšŒ
** `help` - ë„ì›€ë§ í‘œì‹œ

**ê¸°ìˆ  ìŠ¤íƒ**:
* `@slack/bolt` v3.17.1 - Slack API ê³µì‹ SDK
* Socket Mode - ë°©í™”ë²½ ì¹œí™”ì  WebSocket ì—°ê²°

**ì½”ë“œ í’ˆì§ˆ íŠ¹ì§•**:
* ë¹„ë™ê¸° ì²˜ë¦¬ (`async/await`)
* ì—ëŸ¬ í•¸ë“¤ë§ (try-catch)
* Slack Block Kitì„ í™œìš©í•œ ë¦¬ì¹˜ ë©”ì‹œì§€ í¬ë§·íŒ…

{{code language="javascript"}}
// ì˜ˆì œ: Slack Block Kitì„ ì‚¬ìš©í•œ ì„¸ì…˜ ëª©ë¡ í‘œì‹œ
async handleList() {
  const sessions = await this.tmux.listSessions();

  const blocks = [
    { type: 'header', text: { type: 'plain_text', text: 'ğŸ“‹ Active Tmux Sessions' } },
    { type: 'divider' }
  ];

  sessions.forEach(session => {
    blocks.push({
      type: 'section',
      fields: [
        { type: 'mrkdwn', text: `*Name:*\n\`${session.name}\`` },
        { type: 'mrkdwn', text: `*Status:*\n${session.attached ? 'ğŸŸ¢ Attached' : 'âšª Detached'}` }
      ]
    });
  });

  return { response_type: 'in_channel', blocks };
}
{{/code}}

==== 2.2.2 Tmux Wrapper (tmux-wrapper.js) ====

**ì—­í• **: Tmux ëª…ë ¹ì–´ ì‹¤í–‰ì„ ìœ„í•œ ì¶”ìƒí™” ë ˆì´ì–´

**ì„¤ê³„ íŒ¨í„´**:
* **Facade Pattern**: ë³µì¡í•œ tmux CLIë¥¼ ë‹¨ìˆœí•œ JavaScript APIë¡œ ì¶”ìƒí™”
* **Promisify**: ì½œë°± ê¸°ë°˜ `child_process.exec`ë¥¼ Promise ê¸°ë°˜ìœ¼ë¡œ ë³€í™˜

**ì£¼ìš” ë©”ì„œë“œ**:

|= ë©”ì„œë“œ |= ê¸°ëŠ¥ |= ë°˜í™˜ê°’
| `listSessions()` | ëª¨ë“  tmux ì„¸ì…˜ ì¡°íšŒ | Array<SessionInfo>
| `createSession(name, dir)` | ìƒˆ ì„¸ì…˜ ìƒì„± | {success: boolean}
| `killSession(name)` | ì„¸ì…˜ ì¢…ë£Œ | {success: boolean}
| `execCommand(name, cmd)` | ëª…ë ¹ ì‹¤í–‰ | {success: boolean, command: string}
| `captureOutput(name, lines)` | ì¶œë ¥ ìº¡ì²˜ | string
| `getSessionInfo(name)` | ì„¸ì…˜ ìƒì„¸ ì •ë³´ | SessionInfo
| `streamOutput(name, interval)` | ì‹¤ì‹œê°„ ì¶œë ¥ ìŠ¤íŠ¸ë¦¼ | Stream

**ë³´ì•ˆ ê³ ë ¤ì‚¬í•­**:
* ëª…ë ¹ì–´ ì¸ì ì…˜ ë°©ì§€: í°ë”°ì˜´í‘œ ì´ìŠ¤ì¼€ì´í•‘ ì²˜ë¦¬
{{code language="javascript"}}
const cmd = `tmux send-keys -t ${sessionName} "${command.replace(/"/g, '\\"')}" Enter`;
{{/code}}

* Socket ê¸°ë°˜ ì„¸ì…˜ ê²©ë¦¬: ê° ì„¸ì…˜ì´ ë…ë¦½ì ì¸ ì†Œì¼“ íŒŒì¼ ì‚¬ìš©
{{code language="javascript"}}
getSocketPath(sessionName) {
  return `${this.socketDir}/${sessionName}`;
}
{{/code}}

==== 2.2.3 WebSocket Server (websocket-server.js) ====

**ì—­í• **: ì‹¤ì‹œê°„ í„°ë¯¸ë„ ì¶œë ¥ ìŠ¤íŠ¸ë¦¬ë° ì„œë¹„ìŠ¤

**í”„ë¡œí† ì½œ ì„¤ê³„**:

{{code language="json"}}
// í´ë¼ì´ì–¸íŠ¸ â†’ ì„œë²„
{
  "action": "subscribe",
  "session": "myproject"
}

// ì„œë²„ â†’ í´ë¼ì´ì–¸íŠ¸ (ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¼)
{
  "type": "output",
  "session": "myproject",
  "data": "$ ls -la\ntotal 128\ndrwxr-xr-x ...",
  "timestamp": "2025-10-01T12:34:56.789Z"
}
{{/code}}

**ì§€ì› ì•¡ì…˜**:
* `subscribe` - ì„¸ì…˜ ì¶œë ¥ êµ¬ë…
* `unsubscribe` - êµ¬ë… í•´ì œ
* `exec` - ëª…ë ¹ ì‹¤í–‰
* `sendKeys` - íŠ¹ìˆ˜ í‚¤ ì „ì†¡ (Ctrl-C ë“±)
* `capture` - ìŠ¤ëƒ…ìƒ· ìº¡ì²˜
* `list` - ì„¸ì…˜ ëª©ë¡
* `create` - ì„¸ì…˜ ìƒì„±
* `kill` - ì„¸ì…˜ ì‚­ì œ

**ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° ë©”ì»¤ë‹ˆì¦˜**:
* **Polling Interval**: 500msë§ˆë‹¤ ì¶œë ¥ ìº¡ì²˜
* **ë³€ê²½ ê°ì§€**: ì´ì „ ì¶œë ¥ê³¼ ë¹„êµí•˜ì—¬ ë³€ê²½ ì‹œë§Œ ì „ì†¡ (ëŒ€ì—­í­ ìµœì í™”)
* **í´ë¼ì´ì–¸íŠ¸ êµ¬ë… ê´€ë¦¬**: Map ìë£Œêµ¬ì¡°ë¡œ í´ë¼ì´ì–¸íŠ¸ë³„ êµ¬ë… ìƒíƒœ ì¶”ì 

{{code language="javascript"}}
streamOutput(sessionName, intervalMs = 500) {
  let lastOutput = '';

  return {
    start: (callback) => {
      const interval = setInterval(async () => {
        const output = await this.captureOutput(sessionName, 50);
        if (output !== lastOutput) {
          callback(output);  // ë³€ê²½ ì‹œë§Œ ì „ì†¡
          lastOutput = output;
        }
      }, intervalMs);

      return () => clearInterval(interval);
    }
  };
}
{{/code}}

==== 2.2.4 Main Server (index.js) ====

**ì—­í• **: ì• í”Œë¦¬ì¼€ì´ì…˜ ì—”íŠ¸ë¦¬í¬ì¸íŠ¸ ë° ë¼ì´í”„ì‚¬ì´í´ ê´€ë¦¬

**ì£¼ìš” ì±…ì„**:
* ì„¤ì • ê²€ì¦
* WebSocket ì„œë²„ ì´ˆê¸°í™”
* Slack Bot ì´ˆê¸°í™”
* Graceful Shutdown ì²˜ë¦¬

**Graceful Shutdown êµ¬í˜„**:
{{code language="javascript"}}
setupShutdownHandlers() {
  const shutdown = async (signal) => {
    console.log(`ğŸ›‘ Received ${signal}, shutting down gracefully...`);

    if (this.slackBot) await this.slackBot.stop();
    if (this.wsServer) this.wsServer.close();

    process.exit(0);
  };

  process.on('SIGINT', () => shutdown('SIGINT'));
  process.on('SIGTERM', () => shutdown('SIGTERM'));
  process.on('uncaughtException', (error) => shutdown('uncaughtException'));
  process.on('unhandledRejection', (reason) => shutdown('unhandledRejection'));
}
{{/code}}

=== 2.3 ë°ì´í„° íë¦„ ë¶„ì„ ===

==== 2.3.1 ë™ê¸°ì‹ ëª…ë ¹ ì‹¤í–‰ í”Œë¡œìš° ====

{{code language="text"}}
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   /tmux exec myproject ls   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚ Slack API    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                               â–¼
                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                        â”‚ Slack Bot    â”‚
                                        â”‚ Handler      â”‚
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                               â–¼
                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                        â”‚ Tmux Wrapper â”‚
                                        â”‚ .execCommand â”‚
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                               â–¼
                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                        â”‚ tmux CLI     â”‚
                                        â”‚ send-keys    â”‚
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                               â–¼
                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                        â”‚ Tmux Session â”‚
                                        â”‚ (ëª…ë ¹ ì‹¤í–‰)   â”‚
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                               â–¼
                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                        â”‚ Slack        â”‚
                  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Response     â”‚
                  "âœ… Command executed" â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
{{/code}}

==== 2.3.2 ë¹„ë™ê¸°ì‹ ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° í”Œë¡œìš° ====

{{code language="text"}}
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  1. WebSocket ì—°ê²°   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Web Client â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚ WS Server        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                      â”‚
      â”‚  2. {"action": "subscribe",         â”‚
      â”‚      "session": "myproject"}        â”‚
      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
      â”‚                                      â”‚
      â”‚                                      â–¼
      â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                              â”‚ Start Polling    â”‚
      â”‚                              â”‚ (500ms interval) â”‚
      â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                      â”‚
      â”‚                                      â–¼
      â”‚  3. ì‹¤ì‹œê°„ ì¶œë ¥ ìŠ¤íŠ¸ë¦¼       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ tmux capture-paneâ”‚
      â”‚  {"type": "output",          â”‚ (diff detection) â”‚
      â”‚   "data": "...",              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚   "timestamp": "..."}              â”‚
      â”‚                                    â–¼
      â”‚                              ê³„ì† ë°˜ë³µ (ì„¸ì…˜ ì¢…ë£Œ ì‹œê¹Œì§€)
{{/code}}

----

== 3. ê¸°ìˆ  ìŠ¤íƒ ì‹¬ì¸µ ë¶„ì„ ==

=== 3.1 í•µì‹¬ ì˜ì¡´ì„± ë¶„ì„ ===

==== 3.1.1 @slack/bolt (v3.17.1) ====

**ì„ íƒ ì´ìœ **:
* Slack ê³µì‹ ì§€ì› SDK
* Socket Mode ë„¤ì´í‹°ë¸Œ ì§€ì›
* Block Kit í†µí•©
* TypeScript íƒ€ì… ì •ì˜ í¬í•¨

**ì£¼ìš” ê¸°ëŠ¥ í™œìš©**:
* `app.command()` - Slash ëª…ë ¹ì–´ í•¸ë“¤ëŸ¬
* `app.event()` - ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
* Socket Mode - ì¸ë°”ìš´ë“œ ë°©í™”ë²½ ê·œì¹™ ë¶ˆí•„ìš”

==== 3.1.2 ws (v8.16.0) ====

**ì„ íƒ ì´ìœ **:
* ê°€ë³ê³  ë¹ ë¥¸ WebSocket êµ¬í˜„
* Node.js ë„¤ì´í‹°ë¸Œ í˜¸í™˜ì„±
* ë‚®ì€ ë©”ëª¨ë¦¬ ì˜¤ë²„í—¤ë“œ

**ëŒ€ì•ˆ ë¹„êµ**:

|= ë¼ì´ë¸ŒëŸ¬ë¦¬ |= ì¥ì  |= ë‹¨ì  |= ì„ íƒ ì—¬ë¶€
| **ws** | ê²½ëŸ‰, ë¹ ë¦„, ë‹¨ìˆœ | ì¶”ê°€ ê¸°ëŠ¥ ì—†ìŒ | âœ… ì„ íƒ
| socket.io | í’ë¶€í•œ ê¸°ëŠ¥, ìë™ ì¬ì—°ê²° | ë¬´ê±°ì›€, ë³µì¡í•œ í”„ë¡œí† ì½œ | âŒ
| uWebSockets.js | ê·¹í•œì˜ ì„±ëŠ¥ | C++ ì˜ì¡´ì„±, ì•ˆì •ì„± ì´ìŠˆ | âŒ

==== 3.1.3 dotenv (v16.4.1) ====

**ìš©ë„**: í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬

**í•„ìˆ˜ ì„¤ì • ê°’**:
{{code language="bash"}}
SLACK_BOT_TOKEN=xoxb-your-bot-token
SLACK_APP_TOKEN=xapp-your-app-token
SLACK_SIGNING_SECRET=your-signing-secret
WS_PORT=3001
TMUX_SOCKET_DIR=/home/jclee/.tmux/sockets
{{/code}}

=== 3.2 ëŸ°íƒ€ì„ í™˜ê²½ ìš”êµ¬ì‚¬í•­ ===

|= í•­ëª© |= ìµœì†Œ ë²„ì „ |= ê¶Œì¥ ë²„ì „ |= ë¹„ê³ 
| Node.js | v16.0.0 | v20.x LTS | ES Modules ì§€ì› í•„ìˆ˜
| npm | v8.0.0 | v10.x | package-lock v3
| tmux | v2.6 | v3.3+ | capture-pane -p ì§€ì›
| OS | Linux/macOS | Ubuntu 22.04 | Windows WSL2 ì§€ì›

----

== 4. ë³´ì•ˆ ë° ì•ˆì •ì„± ë¶„ì„ ==

=== 4.1 ë³´ì•ˆ ìœ„í˜‘ ëª¨ë¸ ===

==== 4.1.1 ì‹ë³„ëœ ìœ„í˜‘ ====

|= ìœ„í˜‘ |= ì‹¬ê°ë„ |= í˜„ì¬ ì™„í™” ì¡°ì¹˜ |= ì¶”ê°€ ê¶Œì¥ ì‚¬í•­
| **ëª…ë ¹ì–´ ì¸ì ì…˜** | ğŸ”´ HIGH | í°ë”°ì˜´í‘œ ì´ìŠ¤ì¼€ì´í•‘ | í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê¸°ë°˜ ëª…ë ¹ì–´ ê²€ì¦
| **ë¬´ì œí•œ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©** | ğŸŸ¡ MEDIUM | ì—†ìŒ | Rate limiting, Resource quota
| **ë¯¼ê° ì •ë³´ ë…¸ì¶œ** | ğŸŸ¡ MEDIUM | ì—†ìŒ | ì¶œë ¥ í•„í„°ë§ (íŒ¨ìŠ¤ì›Œë“œ, í† í° ë§ˆìŠ¤í‚¹)
| **ì¸ì¦ ìš°íšŒ** | ğŸŸ¢ LOW | Slack OAuth | Role-based access control
| **DoS ê³µê²©** | ğŸŸ¡ MEDIUM | ì—†ìŒ | Connection limit, Timeout ì„¤ì •

==== 4.1.2 ë³´ì•ˆ ê°•í™” ê¶Œì¥ì‚¬í•­ ====

**1. ëª…ë ¹ì–´ ì‹¤í–‰ ì œí•œ**
{{code language="javascript"}}
// ê¶Œì¥: ëª…ë ¹ì–´ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê²€ì¦
const ALLOWED_COMMANDS = ['ls', 'pwd', 'cat', 'grep', 'tail', 'head'];

validateCommand(command) {
  const baseCmd = command.trim().split(/\s+/)[0];
  if (!ALLOWED_COMMANDS.includes(baseCmd)) {
    throw new Error(`Command not allowed: ${baseCmd}`);
  }
}
{{/code}}

**2. Rate Limiting êµ¬í˜„**
{{code language="javascript"}}
// ê¶Œì¥: Slack ì‚¬ìš©ìë³„ Rate Limit
const userRateLimits = new Map();

async checkRateLimit(userId) {
  const now = Date.now();
  const userLimit = userRateLimits.get(userId) || { count: 0, resetTime: now + 60000 };

  if (now > userLimit.resetTime) {
    userLimit.count = 0;
    userLimit.resetTime = now + 60000;
  }

  if (userLimit.count >= 30) {  // ë¶„ë‹¹ 30íšŒ ì œí•œ
    throw new Error('Rate limit exceeded. Try again later.');
  }

  userLimit.count++;
  userRateLimits.set(userId, userLimit);
}
{{/code}}

**3. ë¯¼ê° ì •ë³´ í•„í„°ë§**
{{code language="javascript"}}
// ê¶Œì¥: ì¶œë ¥ì—ì„œ ë¯¼ê° ì •ë³´ ë§ˆìŠ¤í‚¹
function sanitizeOutput(output) {
  return output
    .replace(/password[:\s]*[\w\d]+/gi, 'password: ********')
    .replace(/api[_-]?key[:\s]*[\w\d]+/gi, 'api_key: ********')
    .replace(/token[:\s]*[\w\d]+/gi, 'token: ********');
}
{{/code}}

=== 4.2 ì•ˆì •ì„± ë¶„ì„ ===

==== 4.2.1 ì—ëŸ¬ ì²˜ë¦¬ íŒ¨í„´ ====

**ê°•ì **:
* ëª¨ë“  ë¹„ë™ê¸° í•¨ìˆ˜ì— try-catch ì ìš©
* ì‚¬ìš©ì ì¹œí™”ì  ì—ëŸ¬ ë©”ì‹œì§€
* Graceful shutdown êµ¬í˜„

**ê°œì„  í•„ìš” ì˜ì—­**:
* ì¬ì‹œë„ ë¡œì§ ë¶€ì¬
* ì—ëŸ¬ ë¡œê¹… ë° ëª¨ë‹ˆí„°ë§ ë¯¸ë¹„
* Circuit breaker íŒ¨í„´ ë¯¸ì ìš©

==== 4.2.2 ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ ====

**ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ìœ„í—˜**:
* WebSocket êµ¬ë… ê´€ë¦¬: âœ… ì ì ˆíˆ ì²˜ë¦¬ë¨ (Map ìë™ ì •ë¦¬)
* íƒ€ì´ë¨¸ ê´€ë¦¬: âœ… stopStreaming() ì½œë°±ìœ¼ë¡œ clearInterval
* Tmux í”„ë¡œì„¸ìŠ¤: âš ï¸ ì¢€ë¹„ í”„ë¡œì„¸ìŠ¤ ê°€ëŠ¥ì„± ì¡´ì¬

**ê¶Œì¥ ê°œì„ ì‚¬í•­**:
{{code language="javascript"}}
// ì¢€ë¹„ tmux ì„¸ì…˜ ì •ë¦¬ ìŠ¤ì¼€ì¤„ëŸ¬
setInterval(async () => {
  const sessions = await this.tmux.listSessions();
  const now = Date.now();

  for (const session of sessions) {
    const age = now - session.created.getTime();
    if (!session.attached && age > 24 * 60 * 60 * 1000) {  // 24ì‹œê°„ ì´ìƒ
      console.log(`Cleaning up stale session: ${session.name}`);
      await this.tmux.killSession(session.name);
    }
  }
}, 60 * 60 * 1000);  // 1ì‹œê°„ë§ˆë‹¤
{{/code}}

----

== 5. ì„±ëŠ¥ ë¶„ì„ ë° ìµœì í™” ==

=== 5.1 í˜„ì¬ ì„±ëŠ¥ íŠ¹ì„± ===

==== 5.1.1 ì‘ë‹µ ì‹œê°„ ë¶„ì„ ====

|= ì‘ì—… |= ì˜ˆìƒ ì‘ë‹µ ì‹œê°„ |= ë³‘ëª© ì§€ì  |= ìµœì í™” ê°€ëŠ¥ì„±
| Slack ëª…ë ¹ì–´ â†’ ì‘ë‹µ | 100-300ms | Slack API RTT | ğŸŸ¡ ë³´í†µ
| ëª…ë ¹ ì‹¤í–‰ (exec) | 50-100ms | tmux CLI ì˜¤ë²„í—¤ë“œ | ğŸŸ¢ ë‚®ìŒ
| ì„¸ì…˜ ëª©ë¡ ì¡°íšŒ | 20-50ms | tmux list-sessions | ğŸŸ¢ ë‚®ìŒ
| ì¶œë ¥ ìº¡ì²˜ (100 lines) | 30-80ms | tmux capture-pane | ğŸŸ¡ ë³´í†µ
| WebSocket ìŠ¤íŠ¸ë¦¬ë° | 500ms (ì§€ì—°) | Polling interval | ğŸ”´ ë†’ìŒ

==== 5.1.2 ì²˜ë¦¬ëŸ‰ ë¶„ì„ ====

**ë™ì‹œ ì‚¬ìš©ì ì§€ì›**:
* í˜„ì¬ êµ¬ì¡°: ë‹¨ì¼ Node.js í”„ë¡œì„¸ìŠ¤
* ì˜ˆìƒ ì²˜ë¦¬ëŸ‰: ~100 ë™ì‹œ ì‚¬ìš©ì
* ì œí•œ ìš”ì†Œ: WebSocket ì—°ê²° ìˆ˜, ë©”ëª¨ë¦¬

**í™•ì¥ì„± ë³‘ëª©**:
* CPU: ğŸŸ¢ ë‚®ìŒ (I/O ë°”ìš´ë“œ ì‘ì—…)
* ë©”ëª¨ë¦¬: ğŸŸ¡ ë³´í†µ (ì„¸ì…˜ë‹¹ ~2MB)
* ë„¤íŠ¸ì›Œí¬: ğŸŸ¢ ë‚®ìŒ (í…ìŠ¤íŠ¸ ê¸°ë°˜)

=== 5.2 ìµœì í™” ì „ëµ ===

==== 5.2.1 ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° ìµœì í™” ====

**ë¬¸ì œì **: 500ms ê³ ì • polling interval â†’ ë°˜ì‘ì„± ì €í•˜

**í•´ê²° ë°©ì•ˆ**: ì´ë²¤íŠ¸ ê¸°ë°˜ ìŠ¤íŠ¸ë¦¬ë°

{{code language="bash"}}
# tmuxì˜ ë‚´ì¥ hook í™œìš©
tmux set-hook -g pane-output "run-shell 'curl -X POST http://localhost:3001/notify'"
{{/code}}

{{code language="javascript"}}
// WebSocket Serverì— notification endpoint ì¶”ê°€
app.post('/notify', (req, res) => {
  const { session } = req.body;
  this.notifySubscribers(session);
  res.sendStatus(200);
});
{{/code}}

**ì˜ˆìƒ íš¨ê³¼**: ì‘ë‹µ ì§€ì—° 500ms â†’ 10ms ì´í•˜

==== 5.2.2 ìºì‹± ì „ëµ ====

**ì„¸ì…˜ ëª©ë¡ ìºì‹±**:
{{code language="javascript"}}
class TmuxWrapperOptimized extends TmuxWrapper {
  constructor() {
    super();
    this.sessionCache = { data: null, expiry: 0 };
    this.CACHE_TTL = 5000;  // 5ì´ˆ
  }

  async listSessions() {
    const now = Date.now();
    if (this.sessionCache.data && now < this.sessionCache.expiry) {
      return this.sessionCache.data;
    }

    const sessions = await super.listSessions();
    this.sessionCache = { data: sessions, expiry: now + this.CACHE_TTL };
    return sessions;
  }
}
{{/code}}

**ì˜ˆìƒ íš¨ê³¼**:
* í‰ê·  ì‘ë‹µ ì‹œê°„: 50ms â†’ 1ms
* tmux CLI í˜¸ì¶œ ê°ì†Œ: 90%

==== 5.2.3 ìˆ˜í‰ í™•ì¥ ì•„í‚¤í…ì²˜ ====

**í˜„ì¬ ì œì•½**: ë‹¨ì¼ ì„œë²„ êµ¬ì¡°

**ì œì•ˆ ì•„í‚¤í…ì²˜**:
{{code language="text"}}
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Load Balancer                      â”‚
â”‚              (Nginx / HAProxy)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚              â”‚              â”‚
         â–¼              â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Bridge #1    â”‚ â”‚ Bridge #2    â”‚ â”‚ Bridge #N    â”‚
â”‚ (Port 3001)  â”‚ â”‚ (Port 3002)  â”‚ â”‚ (Port 300N)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚              â”‚              â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚  Redis (Session DB)  â”‚
             â”‚  - Session Metadata  â”‚
             â”‚  - Lock Management   â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚   Shared Tmux Host   â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
{{/code}}

**ì˜ˆìƒ ì²˜ë¦¬ëŸ‰**: ~1,000 ë™ì‹œ ì‚¬ìš©ì

----

== 6. ìš´ì˜ ë° ëª¨ë‹ˆí„°ë§ ==

=== 6.1 ë°°í¬ ì „ëµ ===

==== 6.1.1 Docker ë°°í¬ ====

**í˜„ì¬ ì§€ì› ìƒíƒœ**: âœ… docker-compose.yml ì œê³µ

**ë°°í¬ ëª…ë ¹ì–´**:
{{code language="bash"}}
# ë¹Œë“œ
npm run docker:build

# ì‹¤í–‰
npm run docker:up

# ë¡œê·¸ í™•ì¸
npm run docker:logs

# ì¤‘ì§€
npm run docker:down
{{/code}}

==== 6.1.2 í”„ë¡œë•ì…˜ ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸ ====

{{warning}}
**í•„ìˆ˜ í™•ì¸ ì‚¬í•­**

* [ ] í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ì™„ë£Œ (.env)
* [ ] Slack App í† í° ê²€ì¦
* [ ] Socket Mode í™œì„±í™” í™•ì¸
* [ ] ë°©í™”ë²½ ì„¤ì • (WebSocket í¬íŠ¸)
* [ ] Tmux ì†Œì¼“ ë””ë ‰í† ë¦¬ ê¶Œí•œ ì„¤ì •
* [ ] ë¡œê·¸ ìˆ˜ì§‘ ì„¤ì • (Grafana/Loki)
* [ ] í—¬ìŠ¤ ì²´í¬ ì—”ë“œí¬ì¸íŠ¸ êµ¬ì„±
* [ ] ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ ì„¤ì •
* [ ] ë°±ì—… ë° ë³µêµ¬ ê³„íš ìˆ˜ë¦½
* [ ] ë³´ì•ˆ ì·¨ì•½ì  ìŠ¤ìº” ì™„ë£Œ
{{/warning}}

=== 6.2 ëª¨ë‹ˆí„°ë§ ì „ëµ ===

==== 6.2.1 í•µì‹¬ ë©”íŠ¸ë¦­ ====

**ì„œë¹„ìŠ¤ í—¬ìŠ¤**:
* `slack_bot_connected` (boolean): Slack Bot ì—°ê²° ìƒíƒœ
* `websocket_connections_total` (gauge): í™œì„± WebSocket ì—°ê²° ìˆ˜
* `tmux_sessions_total` (gauge): í™œì„± tmux ì„¸ì…˜ ìˆ˜

**ì„±ëŠ¥ ë©”íŠ¸ë¦­**:
* `command_execution_duration_seconds` (histogram): ëª…ë ¹ ì‹¤í–‰ ì‹œê°„
* `output_capture_duration_seconds` (histogram): ì¶œë ¥ ìº¡ì²˜ ì‹œê°„
* `slack_response_time_seconds` (histogram): Slack ì‘ë‹µ ì‹œê°„

**ì—ëŸ¬ ë©”íŠ¸ë¦­**:
* `command_errors_total` (counter): ëª…ë ¹ ì‹¤í–‰ ì‹¤íŒ¨ íšŸìˆ˜
* `websocket_errors_total` (counter): WebSocket ì—ëŸ¬ ë°œìƒ íšŸìˆ˜
* `session_creation_failures_total` (counter): ì„¸ì…˜ ìƒì„± ì‹¤íŒ¨ íšŸìˆ˜

==== 6.2.2 Grafana í†µí•© ====

**Prometheus Exporter êµ¬í˜„ ì˜ˆì œ**:
{{code language="javascript"}}
import promClient from 'prom-client';

const register = new promClient.Registry();

// ë©”íŠ¸ë¦­ ì •ì˜
const wsConnectionsGauge = new promClient.Gauge({
  name: 'websocket_connections_total',
  help: 'Number of active WebSocket connections',
  registers: [register]
});

const commandDurationHistogram = new promClient.Histogram({
  name: 'command_execution_duration_seconds',
  help: 'Command execution time',
  labelNames: ['command_type'],
  registers: [register]
});

// Express ì—”ë“œí¬ì¸íŠ¸
app.get('/metrics', async (req, res) => {
  res.set('Content-Type', register.contentType);
  res.end(await register.metrics());
});
{{/code}}

**Grafana ëŒ€ì‹œë³´ë“œ ì¿¼ë¦¬ ì˜ˆì œ**:
{{code language="promql"}}
# í‰ê·  ëª…ë ¹ ì‹¤í–‰ ì‹œê°„
rate(command_execution_duration_seconds_sum[5m])
  /
rate(command_execution_duration_seconds_count[5m])

# WebSocket ì—°ê²° ìˆ˜ ì¶”ì´
websocket_connections_total

# ì—ëŸ¬ìœ¨
rate(command_errors_total[5m]) * 100
{{/code}}

=== 6.3 ë¡œê¹… ì „ëµ ===

==== 6.3.1 êµ¬ì¡°í™”ëœ ë¡œê¹… ====

**í˜„ì¬ ìƒíƒœ**: ê¸°ë³¸ console.log ì‚¬ìš©

**ê¶Œì¥ ê°œì„ **: Winston + Loki í†µí•©
{{code language="javascript"}}
import winston from 'winston';
import LokiTransport from 'winston-loki';

const logger = winston.createLogger({
  format: winston.format.json(),
  transports: [
    new winston.transports.Console(),
    new LokiTransport({
      host: 'http://grafana.jclee.me:3100',
      labels: { job: 'slack-tmux-bridge' },
      json: true,
      format: winston.format.json(),
      replaceTimestamp: true,
      onConnectionError: (err) => console.error(err)
    })
  ]
});

// ì‚¬ìš© ì˜ˆ
logger.info('Command executed', {
  user: userId,
  session: sessionName,
  command: command,
  duration: executionTime
});
{{/code}}

==== 6.3.2 ë¡œê·¸ ë ˆë²¨ ì •ì±… ====

|= ë ˆë²¨ |= ìš©ë„ |= ì˜ˆì‹œ
| **ERROR** | ì‹œìŠ¤í…œ ì—ëŸ¬, ì˜ˆì™¸ ìƒí™© | "Failed to connect to Slack API"
| **WARN** | ê²½ê³ , ë¹„ì •ìƒì  ìƒí™© | "Session not found, creating new one"
| **INFO** | ì£¼ìš” ì‘ì—… ì™„ë£Œ | "Command executed: ls -la"
| **DEBUG** | ë””ë²„ê¹… ì •ë³´ | "WebSocket message received: {...}"

----

== 7. í…ŒìŠ¤íŠ¸ ì „ëµ ==

=== 7.1 í˜„ì¬ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ===

**í…ŒìŠ¤íŠ¸ íŒŒì¼**:
* `test/test-tmux-wrapper.js` - Tmux Wrapper ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
* `test/test-websocket.js` - WebSocket í†µí•© í…ŒìŠ¤íŠ¸

**ì»¤ë²„ë¦¬ì§€ ì¶”ì •**: ~30% (ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë§Œ ì¡´ì¬)

=== 7.2 í…ŒìŠ¤íŠ¸ ê°œì„  ê³„íš ===

==== 7.2.1 ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ í™•ëŒ€ ====

**ì¶”ê°€ í•„ìš” í…ŒìŠ¤íŠ¸**:
{{code language="javascript"}}
// Slack Bot Handler í…ŒìŠ¤íŠ¸
describe('SlackBot', () => {
  it('should parse /tmux list command correctly', async () => {
    const result = await bot.handleTmuxCommand('list');
    expect(result.response_type).toBe('in_channel');
  });

  it('should validate session name format', async () => {
    await expect(bot.handleCreate('invalid-name!')).rejects.toThrow();
  });

  it('should handle rate limiting', async () => {
    for (let i = 0; i < 31; i++) {
      await bot.handleTmuxCommand('list');
    }
    await expect(bot.handleTmuxCommand('list')).rejects.toThrow('Rate limit');
  });
});
{{/code}}

==== 7.2.2 í†µí•© í…ŒìŠ¤íŠ¸ ====

**E2E ì‹œë‚˜ë¦¬ì˜¤**:
{{code language="javascript"}}
describe('E2E: Complete workflow', () => {
  it('should execute command via Slack and stream output via WebSocket', async () => {
    // 1. Slackìœ¼ë¡œ ì„¸ì…˜ ìƒì„±
    await slackClient.command('/tmux create test-session');

    // 2. WebSocket ì—°ê²°
    const ws = new WebSocket('ws://localhost:3001');
    await waitForConnection(ws);

    // 3. ì„¸ì…˜ êµ¬ë…
    ws.send(JSON.stringify({ action: 'subscribe', session: 'test-session' }));

    // 4. Slackìœ¼ë¡œ ëª…ë ¹ ì‹¤í–‰
    await slackClient.command('/tmux exec test-session echo "Hello World"');

    // 5. WebSocketìœ¼ë¡œ ì¶œë ¥ ìˆ˜ì‹  í™•ì¸
    const output = await waitForOutput(ws, 5000);
    expect(output).toContain('Hello World');

    // 6. ì •ë¦¬
    ws.close();
    await slackClient.command('/tmux kill test-session');
  });
});
{{/code}}

==== 7.2.3 ë¶€í•˜ í…ŒìŠ¤íŠ¸ ====

**k6 ë¶€í•˜ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤**:
{{code language="javascript"}}
import ws from 'k6/ws';
import { check } from 'k6';

export let options = {
  stages: [
    { duration: '1m', target: 50 },   // 50ëª…ìœ¼ë¡œ ì¦ê°€
    { duration: '3m', target: 50 },   // 50ëª… ìœ ì§€
    { duration: '1m', target: 100 },  // 100ëª…ìœ¼ë¡œ ì¦ê°€
    { duration: '3m', target: 100 },  // 100ëª… ìœ ì§€
    { duration: '1m', target: 0 },    // ì¢…ë£Œ
  ],
};

export default function () {
  const url = 'ws://localhost:3001';
  const res = ws.connect(url, function (socket) {
    socket.on('open', () => {
      socket.send(JSON.stringify({
        action: 'list'
      }));
    });

    socket.on('message', (data) => {
      check(data, { 'status is OK': (r) => r.includes('type') });
    });

    socket.setTimeout(() => socket.close(), 5000);
  });

  check(res, { 'status is 101': (r) => r && r.status === 101 });
}
{{/code}}

----

== 8. í–¥í›„ ê°œì„  ë¡œë“œë§µ ==

=== 8.1 ë‹¨ê¸° ê°œì„  (1-3ê°œì›”) ===

==== Priority 1: ë³´ì•ˆ ê°•í™” ====
* [ ] ëª…ë ¹ì–´ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ êµ¬í˜„
* [ ] Rate limiting ì¶”ê°€
* [ ] ë¯¼ê° ì •ë³´ í•„í„°ë§
* [ ] RBAC (Role-Based Access Control)

==== Priority 2: ê´€ì°°ì„± ê°œì„  ====
* [ ] Prometheus ë©”íŠ¸ë¦­ exporter
* [ ] Grafana ëŒ€ì‹œë³´ë“œ êµ¬ì¶•
* [ ] Winston + Loki êµ¬ì¡°í™” ë¡œê¹…
* [ ] ë¶„ì‚° ì¶”ì  (OpenTelemetry)

==== Priority 3: ì•ˆì •ì„± í–¥ìƒ ====
* [ ] ìë™ ì¬ì‹œë„ ë¡œì§
* [ ] Circuit breaker íŒ¨í„´
* [ ] ì¢€ë¹„ ì„¸ì…˜ ì •ë¦¬ ìŠ¤ì¼€ì¤„ëŸ¬
* [ ] í—¬ìŠ¤ ì²´í¬ ì—”ë“œí¬ì¸íŠ¸

=== 8.2 ì¤‘ê¸° ê°œì„  (3-6ê°œì›”) ===

==== Feature Enhancement ====
* [ ] **íŒŒì¼ ì—…ë¡œë“œ/ë‹¤ìš´ë¡œë“œ**: Slackì—ì„œ íŒŒì¼ì„ tmux ì„¸ì…˜ìœ¼ë¡œ ì „ì†¡
* [ ] **ì„¸ì…˜ ê³µìœ **: ì—¬ëŸ¬ ì‚¬ìš©ìê°€ ë™ì¼ ì„¸ì…˜ í˜‘ì—…
* [ ] **ìŠ¤ëƒ…ìƒ· ì €ì¥**: í„°ë¯¸ë„ ì¶œë ¥ì„ Slack ìŠ¤ë ˆë“œë¡œ ì•„ì¹´ì´ë¹™
* [ ] **ìŠ¤ì¼€ì¤„ ëª…ë ¹ ì‹¤í–‰**: Cron ìŠ¤íƒ€ì¼ ì˜ˆì•½ ì‹¤í–‰
* [ ] **ì„¸ì…˜ í…œí”Œë¦¿**: ë¯¸ë¦¬ ì •ì˜ëœ í™˜ê²½ ì„¤ì •ìœ¼ë¡œ ì„¸ì…˜ ìƒì„±

==== Performance Optimization ====
* [ ] ì´ë²¤íŠ¸ ê¸°ë°˜ ìŠ¤íŠ¸ë¦¬ë° (tmux hooks)
* [ ] Redis ìºì‹± ë ˆì´ì–´
* [ ] ì¶œë ¥ ì••ì¶• (gzip)
* [ ] CDNì„ í†µí•œ ì •ì  ìì‚° ì„œë¹™

=== 8.3 ì¥ê¸° ë¹„ì „ (6-12ê°œì›”) ===

==== í”Œë«í¼ í™•ì¥ ====
* [ ] **Microsoft Teams í†µí•©**
* [ ] **Discord Bot ì§€ì›**
* [ ] **Web UI ëŒ€ì‹œë³´ë“œ**: React ê¸°ë°˜ ê´€ë¦¬ ì½˜ì†”
* [ ] **Mobile App**: iOS/Android ë„¤ì´í‹°ë¸Œ ì•±

==== ì—”í„°í”„ë¼ì´ì¦ˆ ê¸°ëŠ¥ ====
* [ ] **Multi-tenancy**: ì¡°ì§ë³„ ê²©ë¦¬
* [ ] **ê°ì‚¬ ë¡œê·¸**: ì»´í”Œë¼ì´ì–¸ìŠ¤ ëŒ€ì‘
* [ ] **SSO í†µí•©**: SAML, OIDC
* [ ] **On-premise ë°°í¬**: Kubernetes Helm Chart

==== AI/ML í†µí•© ====
* [ ] **ìì—°ì–´ ëª…ë ¹ì–´**: "Show me logs from yesterday" â†’ ìë™ ëª…ë ¹ ë³€í™˜
* [ ] **ì´ìƒ íƒì§€**: ë¹„ì •ìƒì  ëª…ë ¹ íŒ¨í„´ ê°ì§€
* [ ] **ìë™ ë¬¸ì œ í•´ê²°**: ì¼ë°˜ì  ì—ëŸ¬ì— ëŒ€í•œ ìë™ ìˆ˜ì • ì œì•ˆ

----

== 9. ë¹„ì¦ˆë‹ˆìŠ¤ ê°€ì¹˜ ë¶„ì„ ==

=== 9.1 ROI ì¶”ì • ===

==== ì‹œê°„ ì ˆê° íš¨ê³¼ ====

**ì‹œë‚˜ë¦¬ì˜¤**: 10ëª…ì˜ ê°œë°œìê°€ í•˜ë£¨ í‰ê·  20íšŒ ì„œë²„ ì ‘ì†

**í˜„ì¬ ë°©ì‹ (SSH)**:
* SSH í´ë¼ì´ì–¸íŠ¸ ì‹¤í–‰: 10ì´ˆ
* ì„œë²„ ì ‘ì† ëŒ€ê¸°: 5ì´ˆ
* ì‘ì—… ë””ë ‰í† ë¦¬ ì´ë™: 5ì´ˆ
* **ì´**: 20ì´ˆ/íšŒ Ã— 20íšŒ/ì¼ Ã— 10ëª… = **67ì‹œê°„/ì›”**

**Slack Tmux Bridge ë°©ì‹**:
* Slack ëª…ë ¹ì–´ ì…ë ¥: 3ì´ˆ
* ì‘ë‹µ ëŒ€ê¸°: 1ì´ˆ
* **ì´**: 4ì´ˆ/íšŒ Ã— 20íšŒ/ì¼ Ã— 10ëª… = **13ì‹œê°„/ì›”**

**ì ˆê° íš¨ê³¼**:
* ì‹œê°„: **54ì‹œê°„/ì›” (80% ê°ì†Œ)**
* ë¹„ìš© (ì‹œê¸‰ $50 ê¸°ì¤€): **$2,700/ì›”**
* ì—°ê°„: **$32,400**

=== 9.2 ì •ì„±ì  ê°€ì¹˜ ===

**í˜‘ì—… íš¨ìœ¨ì„± í–¥ìƒ**:
* í„°ë¯¸ë„ ì¶œë ¥ì´ Slack ì±„ë„ì— ê³µìœ ë˜ì–´ íŒ€ì› ê°„ ì»¨í…ìŠ¤íŠ¸ ê³µìœ  ìš©ì´
* ë¬¸ì œ í•´ê²° ì‹œ ì‹¤ì‹œê°„ í˜‘ì—… ê°€ëŠ¥
* ë¹„ë™ê¸° ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ì§€ì› (íƒ€ì„ì¡´ ì°¨ì´ ê·¹ë³µ)

**ì ‘ê·¼ì„± ê°œì„ **:
* ëª¨ë°”ì¼ì—ì„œë„ ì„œë²„ ê´€ë¦¬ ê°€ëŠ¥
* SSH í‚¤ ê´€ë¦¬ ë¶ˆí•„ìš”
* ì‹ ê·œ íŒ€ì› ì˜¨ë³´ë”© ì‹œê°„ ë‹¨ì¶•

**ë³´ì•ˆ ë° ì»´í”Œë¼ì´ì–¸ìŠ¤**:
* ëª¨ë“  ëª…ë ¹ ì‹¤í–‰ì´ Slackì— ìë™ ê¸°ë¡
* ê°ì‚¬ ì¶”ì  ìš©ì´
* ì¤‘ì•™ ì§‘ì¤‘ì‹ ê¶Œí•œ ê´€ë¦¬

----

== 10. ê²°ë¡  ë° ê¶Œì¥ì‚¬í•­ ==

=== 10.1 ì¢…í•© í‰ê°€ ===

**ê°•ì **:
* âœ… ëª…í™•í•œ ì•„í‚¤í…ì²˜ ë¶„ë¦¬
* âœ… ë¹„ë™ê¸° ì²˜ë¦¬ ë° ì—ëŸ¬ í•¸ë“¤ë§
* âœ… ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° ì§€ì›
* âœ… Graceful shutdown êµ¬í˜„
* âœ… í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°

**ê°œì„  í•„ìš” ì˜ì—­**:
* âš ï¸ ë³´ì•ˆ ê°•í™” (ëª…ë ¹ì–´ ê²€ì¦, Rate limiting)
* âš ï¸ ê´€ì°°ì„± ë¶€ì¡± (ë©”íŠ¸ë¦­, ë¡œê¹…)
* âš ï¸ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ë‚®ìŒ
* âš ï¸ ì„±ëŠ¥ ìµœì í™” ì—¬ì§€ (ì´ë²¤íŠ¸ ê¸°ë°˜ ìŠ¤íŠ¸ë¦¬ë°)
* âš ï¸ ë¬¸ì„œí™” ë¶€ì¡± (API ëª…ì„¸, ì•„í‚¤í…ì²˜ ë¬¸ì„œ)

=== 10.2 ì¦‰ì‹œ ì‹¤í–‰ ê¶Œì¥ ì•¡ì…˜ ===

{{warning}}
**Critical (ì¦‰ì‹œ)**
1. ëª…ë ¹ì–´ ì¸ì ì…˜ ë°©ì–´ êµ¬í˜„
2. Rate limiting ì¶”ê°€
3. í”„ë¡œë•ì…˜ í™˜ê²½ ë³€ìˆ˜ ê²€ì¦
4. Grafana ë¡œê¹… í†µí•©
{{/warning}}

{{info}}
**High Priority (1ì£¼ ì´ë‚´)**
1. Prometheus ë©”íŠ¸ë¦­ ì¶”ê°€
2. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ 70% ì´ìƒ í™•ë³´
3. ìš´ì˜ í”Œë ˆì´ë¶ ì‘ì„±
4. ë¯¼ê° ì •ë³´ í•„í„°ë§ êµ¬í˜„
{{/info}}

**Medium Priority (1ê°œì›” ì´ë‚´)**:
1. ì´ë²¤íŠ¸ ê¸°ë°˜ ìŠ¤íŠ¸ë¦¬ë°ìœ¼ë¡œ ì „í™˜
2. Redis ìºì‹± ë ˆì´ì–´ ì¶”ê°€
3. Circuit breaker íŒ¨í„´ ì ìš©
4. E2E í…ŒìŠ¤íŠ¸ êµ¬ì¶•

=== 10.3 ìµœì¢… ì˜ê²¬ ===

Slack Tmux BridgeëŠ” **ê°œë°œì ìƒì‚°ì„± í–¥ìƒ**ì„ ìœ„í•œ í˜ì‹ ì ì¸ ë„êµ¬ë¡œ, ê²¬ê³ í•œ ì•„í‚¤í…ì²˜ì™€ ëª…í™•í•œ ì½”ë“œ êµ¬ì¡°ë¥¼ ê°–ì¶”ê³  ìˆìŠµë‹ˆë‹¤. í˜„ì¬ MVP ë‹¨ê³„ë¡œì„œ í•µì‹¬ ê¸°ëŠ¥ì€ ì•ˆì •ì ìœ¼ë¡œ ì‘ë™í•˜ë‚˜, **í”„ë¡œë•ì…˜ ë°°í¬ë¥¼ ìœ„í•´ì„œëŠ” ë³´ì•ˆ ë° ê´€ì°°ì„± ê°•í™”ê°€ í•„ìˆ˜**ì…ë‹ˆë‹¤.

ì œì•ˆëœ ê°œì„  ì‚¬í•­ì„ ë‹¨ê³„ì ìœ¼ë¡œ ì ìš©í•˜ë©´, ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ì„œë¹„ìŠ¤ë¡œ ì„±ì¥í•  ìˆ˜ ìˆëŠ” ì ì¬ë ¥ì´ ì¶©ë¶„í•©ë‹ˆë‹¤. íŠ¹íˆ **ë©€í‹° í”Œë«í¼ í™•ì¥**(Teams, Discord) ë° **AI ê¸°ë°˜ ìë™í™”** ê¸°ëŠ¥ ì¶”ê°€ ì‹œ ì‹œì¥ ê²½ìŸë ¥ì´ í¬ê²Œ í–¥ìƒë  ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.

----

== ë¶€ë¡ ==

=== A. ìš©ì–´ ì‚¬ì „ ===

|= ìš©ì–´ |= ì„¤ëª…
| **tmux** | Terminal Multiplexer - í•˜ë‚˜ì˜ í„°ë¯¸ë„ì—ì„œ ì—¬ëŸ¬ ì„¸ì…˜ì„ ê´€ë¦¬í•˜ëŠ” ë„êµ¬
| **Socket Mode** | Slackì˜ WebSocket ê¸°ë°˜ ì‹¤ì‹œê°„ í†µì‹  ë°©ì‹ (ì¸ë°”ìš´ë“œ ë°©í™”ë²½ ë¶ˆí•„ìš”)
| **Block Kit** | Slackì˜ UI í”„ë ˆì„ì›Œí¬ (ë¦¬ì¹˜ ë©”ì‹œì§€ í¬ë§·íŒ…)
| **Slash Command** | `/` ë¡œ ì‹œì‘í•˜ëŠ” Slack ëª…ë ¹ì–´ (ì˜ˆ: /tmux list)
| **Graceful Shutdown** | í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ ì‹œ ì§„í–‰ ì¤‘ì¸ ì‘ì—… ì™„ë£Œ í›„ ì¢…ë£Œ
| **Rate Limiting** | API í˜¸ì¶œ ë¹ˆë„ ì œí•œ (DDoS ë°©ì–´)
| **Circuit Breaker** | ì¥ì•  ì „íŒŒ ë°©ì§€ íŒ¨í„´ (ì¼ì‹œì  ì„œë¹„ìŠ¤ ì°¨ë‹¨)

=== B. ì°¸ê³  ìë£Œ ===

* [[Slack Bolt Framework>>https://slack.dev/bolt-js/]]
* [[Tmux Manual>>https://man7.org/linux/man-pages/man1/tmux.1.html]]
* [[WebSocket Protocol (RFC 6455)>>https://datatracker.ietf.org/doc/html/rfc6455]]
* [[Node.js Best Practices>>https://github.com/goldbergyoni/nodebestpractices]]
* [[Prometheus Instrumentation>>https://prometheus.io/docs/practices/instrumentation/]]

=== C. ë³€ê²½ ì´ë ¥ ===

|= ë²„ì „ |= ë‚ ì§œ |= ì‘ì„±ì |= ë³€ê²½ ë‚´ìš©
| 1.0 | 2025-10-01 | Claude AI | ì´ˆì•ˆ ì‘ì„±
| - | - | - | -

----

{{info}}
**ë¬¸ì„œ í”¼ë“œë°±**

ì´ ë¶„ì„ ë³´ê³ ì„œì— ëŒ€í•œ ì˜ê²¬ì´ë‚˜ ì¶”ê°€ ì§ˆë¬¸ì´ ìˆìœ¼ì‹œë©´ í”„ë¡œì íŠ¸ ê´€ë¦¬ìì—ê²Œ ì—°ë½í•´ ì£¼ì„¸ìš”.

**ì—°ë½ì²˜**: [[í”„ë¡œì íŠ¸ Issue íŠ¸ë˜ì»¤>>https://github.com/your-org/slack-tmux-bridge/issues]]
{{/info}}
